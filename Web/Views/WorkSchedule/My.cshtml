@model Web.Models.CurrentWorkScheduleViewModel

@{
	ViewData["Title"] = "Lịch làm việc của tôi";
}

@section Styles {
	<link rel="stylesheet" type="text/css" href="~/assets/css/font-awesome.css">
	<!-- ico-font-->
	<link rel="stylesheet" type="text/css" href="~/assets/css/vendors/icofont.css">
	<!-- Themify icon-->
	<link rel="stylesheet" type="text/css" href="~/assets/css/vendors/themify.css">
	<!-- Flag icon-->
	<link rel="stylesheet" type="text/css" href="~/assets/css/vendors/flag-icon.css">
	<!-- Feather icon-->
	<link rel="stylesheet" type="text/css" href="~/assets/css/vendors/feather-icon.css">
	<!-- Plugins css start-->
	<link rel="stylesheet" type="text/css" href="~/assets/css/vendors/slick.css">
	<link rel="stylesheet" type="text/css" href="~/assets/css/vendors/slick-theme.css">
	<link rel="stylesheet" type="text/css" href="~/assets/css/vendors/scrollbar.css">
	<link rel="stylesheet" type="text/css" href="~/assets/css/vendors/animate.css">
	<!-- Plugins css Ends-->
	<!-- Bootstrap css-->
	<link rel="stylesheet" type="text/css" href="~/assets/css/vendors/bootstrap.css">
	<!-- App css-->
	<link rel="stylesheet" type="text/css" href="~/assets/css/style.css">
	<link id="color" rel="stylesheet" href="~/assets/css/color-1.css" media="screen">
	<!-- Responsive css-->
	<link rel="stylesheet" type="text/css" href="~/assets/css/responsive.css">
}

<div class="card">
	<div class="card-body">
		<form asp-action="My" method="get">
            <div class="form-group">
                <label for="weekSelect">Chọn tuần:</label>
                <select id="weekSelect" name="selectedWeek" class="form-control">
                    @foreach (var week in Model.AvailableWeeks)
                    {
						<option value="@week.WeekNumber" selected="@(week.WeekNumber == Model.SelectedWeek ? "selected" : "")">Tuần @week.StartDate to @week.EndDate</option>
                    }
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Xem lịch</button>
        </form>

		<table class="table table-bordered mt-4">
			<thead>
				<tr>
					<th>Khung giờ</th>
					@for (int i = 0; i < 7; i++)
					{
						<th>@System.Globalization.CultureInfo.CurrentCulture.DateTimeFormat.GetDayName((DayOfWeek)i)</th>
					}
				</tr>
			</thead>
			<tbody>
				@foreach (var slot in Model.TimeSlots)
				{
					<tr>
						<td>@slot</td>
						@for (int day = 0; day < 7; day++)
						{
							var schedule = Model.WorkSchedules
							.FirstOrDefault(ws => ws.StartDateTime.HasValue
							&& ws.StartDateTime.Value.DayOfWeek == (DayOfWeek)day
							&& ws.StartDateTime.Value.ToString("hh:mm tt") == slot.Split(" - ")[0]);

							<td>
								@if (schedule != null)
								{
									<div>
										<strong>@schedule.EmployeeName</strong><br />
										<span>@schedule.Status</span>
									</div>
								}
							</td>
						}
					</tr>
				}
			</tbody>
		</table>
	</div>
</div>

@section Scripts {
	<script src="~/assets/js/jquery.min.js"></script>
	<!-- Bootstrap js-->
	<script src="~/assets/js/bootstrap/bootstrap.bundle.min.js"></script>
	<!-- feather icon js-->
	<script src="~/assets/js/icons/feather-icon/feather.min.js"></script>
	<script src="~/assets/js/icons/feather-icon/feather-icon.js"></script>
	<!-- scrollbar js-->
	<script src="~/assets/js/scrollbar/simplebar.js"></script>
	<script src="~/assets/js/scrollbar/custom.js"></script>
	<!-- Sidebar jquery-->
	<script src="~/assets/js/config.js"></script>
	<!-- Plugins JS start-->
	<script src="~/assets/js/sidebar-menu.js"></script>
	<script src="~/assets/js/sidebar-pin.js"></script>
	<script src="~/assets/js/slick/slick.min.js"></script>
	<script src="~/assets/js/slick/slick.js"></script>
	<script src="~/assets/js/header-slick.js"></script>
	<!-- calendar js-->
	<script src="~/assets/js/form-validation-custom.js"></script>
	<script src="~/assets/js/height-equal.js"></script>
	<!-- Plugins JS Ends-->
	<!-- Theme js-->
	<script src="~/assets/js/script.js"></script>
}